# Go-Tunnel-Lite 项目概述

## 1. 项目简介

**Go-Tunnel-Lite** 是一款使用 Go 语言开发的轻量级内网穿透工具，可以将内网服务安全地暴露到公网，实现远程访问。

### 1.1 什么是内网穿透？

内网穿透是一种网络技术，允许处于内网（如家庭网络、公司内网）的服务被外部网络访问。由于 NAT（网络地址转换）的存在，内网设备通常无法被公网直接访问。内网穿透通过在公网服务器和内网客户端之间建立隧道连接，实现数据转发，从而突破这一限制。

### 1.2 为什么选择 Go-Tunnel-Lite？

| 特性 | 说明 |
|------|------|
| **轻量级** | 单文件二进制，无依赖，部署简单 |
| **高性能** | 基于 Go 协程，支持高并发连接 |
| **安全** | Token 认证，端口白名单控制 |
| **易配置** | YAML 配置文件，结构清晰 |
| **可扩展** | 模块化设计，易于二次开发 |

## 2. 核心功能

### 2.1 TCP 隧道

支持任意 TCP 协议的服务穿透：
- **Web 服务**：HTTP/HTTPS 网站、API 服务
- **SSH 服务**：远程登录、文件传输
- **数据库**：MySQL、Redis、PostgreSQL 等
- **自定义服务**：任何基于 TCP 的服务

### 2.2 认证机制

- 基于 Token 的身份认证
- 防止未授权客户端连接
- 支持客户端 ID 唯一标识

### 2.3 心跳保活

- 双向心跳检测（Ping/Pong）
- 可配置的心跳间隔和超时时间
- 自动检测断开连接并清理资源

### 2.4 端口白名单

- 服务端可配置允许使用的端口列表
- 防止客户端滥用端口资源
- 空白名单时允许所有端口（向后兼容）

### 2.5 多隧道支持

- 单个客户端可注册多个隧道
- 每个隧道独立配置本地地址和远程端口

## 3. 应用场景

### 3.1 开发测试场景

```
场景：开发人员需要将本地开发的 Web 服务临时暴露给外部测试人员访问

解决方案：
1. 在公网服务器部署 go-tunnel-server
2. 在开发机器运行 go-tunnel-client
3. 配置隧道：local_addr: 127.0.0.1:3000 → remote_port: 8080
4. 测试人员通过 http://公网IP:8080 访问开发环境
```

### 3.2 远程运维场景

```
场景：需要远程 SSH 登录到公司内网的服务器

解决方案：
1. 在跳板机部署 go-tunnel-server
2. 在内网服务器运行 go-tunnel-client
3. 配置隧道：local_addr: 127.0.0.1:22 → remote_port: 2222
4. 通过 ssh -p 2222 user@跳板机IP 登录内网服务器
```

### 3.3 物联网设备管理

```
场景：远程管理部署在各地的 IoT 设备

解决方案：
1. 在云服务器部署 go-tunnel-server
2. 在每个 IoT 设备运行 go-tunnel-client（配置不同的 remote_port）
3. 通过统一的云服务器入口管理所有设备
```

### 3.4 临时服务共享

```
场景：临时共享本地文件服务器给远程同事

解决方案：
1. 在本地启动一个简单的 HTTP 文件服务器（如 Python http.server）
2. 通过 go-tunnel-client 暴露到公网
3. 共享链接给同事下载文件
```

## 4. 技术栈

| 组件 | 技术选型 | 选择理由 |
|------|----------|----------|
| **编程语言** | Go 1.21+ | 天然并发支持、编译为单二进制、跨平台 |
| **网络通信** | 原生 TCP | 性能最优、协议可控 |
| **序列化** | JSON | 可读性好、调试方便、兼容性强 |
| **配置管理** | YAML | 人类友好、层级清晰 |
| **日志库** | log/slog | Go 1.21 标准库、结构化日志 |
| **构建工具** | Make | 跨平台、简单易用 |

## 5. 系统要求

### 5.1 服务端要求

- 具有公网 IP 的服务器
- 开放控制端口（默认 7000）
- 开放隧道端口（如 8080、2222 等）
- 支持的操作系统：Linux、macOS、Windows

### 5.2 客户端要求

- 能够访问公网（可穿透 NAT）
- 支持的操作系统：Linux、macOS、Windows

## 6. 项目结构

```
go-tunnel-lite/
├── cmd/                    # 入口程序
│   ├── server/            # 服务端入口
│   │   └── main.go
│   └── client/            # 客户端入口
│       └── main.go
├── internal/              # 内部包（不对外暴露）
│   ├── server/           # 服务端核心逻辑
│   │   └── server.go
│   ├── client/           # 客户端核心逻辑
│   │   └── client.go
│   └── pkg/              # 共享包
│       ├── config/       # 配置管理
│       ├── connect/      # 连接封装
│       ├── log/          # 日志模块
│       └── proto/        # 通信协议
├── configs/               # 配置文件示例
│   ├── server.yaml
│   └── client.yaml
├── docs/                  # 文档目录
├── bin/                   # 编译输出
├── Makefile              # 构建脚本
├── go.mod                # Go 模块定义
└── README.md             # 项目说明
```

## 7. 快速开始

详细的安装和使用指南请参阅：
- [02-architecture.md](./02-architecture.md) - 系统架构设计
- [03-protocol.md](./03-protocol.md) - 通信协议详解
- [04-server.md](./04-server.md) - 服务端详解
- [05-client.md](./05-client.md) - 客户端详解
- [06-config.md](./06-config.md) - 配置说明
- [07-deployment.md](./07-deployment.md) - 部署指南
