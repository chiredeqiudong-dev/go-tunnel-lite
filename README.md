# Go-Tunnel-Lite

ğŸš€ ä¸€ä¸ªä½¿ç”¨ Go è¯­è¨€å®ç°çš„è½»é‡çº§å†…ç½‘ç©¿é€éš§é“å·¥å…·ï¼Œæ”¯æŒå°†å†…ç½‘æœåŠ¡æš´éœ²åˆ°å…¬ç½‘ã€‚

## âœ¨ ç‰¹æ€§

- ğŸ” **Token è®¤è¯** - å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯é€šè¿‡ Token è¿›è¡Œå®‰å…¨è®¤è¯
- ğŸ’“ **å¿ƒè·³ä¿æ´»** - è‡ªåŠ¨å¿ƒè·³æ£€æµ‹ï¼Œä¿æŒè¿æ¥ç¨³å®š
- ğŸ”Œ **TCP éš§é“** - æ”¯æŒä»»æ„åŸºäº TCP çš„åè®®ï¼ˆHTTPã€SSHã€MySQL ç­‰ï¼‰
- ğŸ›¡ï¸ **ç«¯å£ç™½åå•** - æœåŠ¡ç«¯å¯é…ç½®å…è®¸ä½¿ç”¨çš„ç«¯å£åˆ—è¡¨
- ğŸ“ **çµæ´»é…ç½®** - æ”¯æŒ YAML é…ç½®æ–‡ä»¶
- ğŸª¶ **è½»é‡ç®€æ´** - æ— ç¬¬ä¸‰æ–¹ä¾èµ–ï¼Œä»£ç ç®€æ´æ˜“æ‡‚

## ğŸ“ æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              å…¬ç½‘æœåŠ¡å™¨                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                         go-tunnel-server                              â”‚  â”‚
â”‚  â”‚                                                                       â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚  â”‚
â”‚  â”‚   â”‚ æ§åˆ¶ç«¯å£     â”‚    â”‚ éš§é“ç«¯å£    â”‚    â”‚ éš§é“ç«¯å£    â”‚              â”‚  â”‚
â”‚  â”‚   â”‚   :7000     â”‚    â”‚   :8080     â”‚    â”‚   :2222     â”‚              â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                  â”‚                  â”‚
              â”‚ æ§åˆ¶è¿æ¥          â”‚ ç”¨æˆ·è¯·æ±‚          â”‚ ç”¨æˆ·è¯·æ±‚
              â”‚                  â”‚                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             â”‚                  â”‚                  â”‚            å†…ç½‘ç¯å¢ƒ       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                         go-tunnel-client                              â”‚  â”‚
â”‚  â”‚                                                                       â”‚  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚  â”‚
â”‚  â”‚   â”‚ æœåŠ¡ç«¯è¿æ¥   â”‚    â”‚ è½¬å‘åˆ°æœ¬åœ°   â”‚    â”‚ è½¬å‘åˆ°æœ¬åœ°   â”‚              â”‚  â”‚
â”‚  â”‚   â”‚   :7000     â”‚â”€â”€â”€â–¶â”‚   :8080     â”‚â”€â”€â”€â–¶â”‚   :22       â”‚              â”‚  â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                â”‚                  â”‚                         â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚                    â”‚  æœ¬åœ° Web æœåŠ¡   â”‚  â”‚  æœ¬åœ° SSH æœåŠ¡  â”‚                â”‚
â”‚                    â”‚    :8080        â”‚  â”‚     :22        â”‚                â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ› ï¸ å®‰è£…

### ä»æºç ç¼–è¯‘

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/your-username/go-tunnel-lite.git
cd go-tunnel-lite

# ç¼–è¯‘ï¼ˆç”Ÿæˆ bin/go-tunnel-server å’Œ bin/go-tunnel-clientï¼‰
make build

# æˆ–å•ç‹¬ç¼–è¯‘
make server   # ä»…ç¼–è¯‘æœåŠ¡ç«¯
make client   # ä»…ç¼–è¯‘å®¢æˆ·ç«¯
```

### è¿è¡Œæµ‹è¯•

```bash
make test
```

## âš™ï¸ é…ç½®

### æœåŠ¡ç«¯é…ç½® (`configs/server.yaml`)

```yaml
server:
  # æ§åˆ¶ç«¯å£åœ°å€ï¼Œå®¢æˆ·ç«¯è¿æ¥æ­¤ç«¯å£
  control_addr: "0.0.0.0:7000"
  # è®¤è¯ä»¤ç‰Œï¼Œéœ€è¦ä¸å®¢æˆ·ç«¯é…ç½®ä¸€è‡´
  token: "my-secret-token"
  # å¿ƒè·³é—´éš”
  heartbeat_interval: 30s
  # å¿ƒè·³è¶…æ—¶ï¼Œè¶…è¿‡æ­¤æ—¶é—´æœªæ”¶åˆ°å¿ƒè·³åˆ™æ–­å¼€è¿æ¥
  heartbeat_timeout: 90s
  # å…è®¸å®¢æˆ·ç«¯ä½¿ç”¨çš„å…¬å…±ç«¯å£ç™½åå•ï¼ˆä¸ºç©ºåˆ™å…è®¸æ‰€æœ‰ç«¯å£ï¼‰
  public_ports:
    - 8080  # Web æœåŠ¡
    - 2222  # SSH æœåŠ¡

log:
  level: "info"    # debug, info, warn, error
  file: ""         # æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼Œä¸ºç©ºåˆ™è¾“å‡ºåˆ°æ§åˆ¶å°
```

### å®¢æˆ·ç«¯é…ç½® (`configs/client.yaml`)

```yaml
client:
  # æœåŠ¡ç«¯åœ°å€
  server_addr: "your-server-ip:7000"
  # è®¤è¯ä»¤ç‰Œï¼Œéœ€è¦ä¸æœåŠ¡ç«¯é…ç½®ä¸€è‡´
  token: "my-secret-token"
  # å¿ƒè·³é—´éš”
  heartbeat_interval: 30s
  # éš§é“é…ç½®åˆ—è¡¨
  tunnels:
    # Web æœåŠ¡éš§é“
    - name: "web"
      local_addr: "127.0.0.1:8080"   # æœ¬åœ°æœåŠ¡åœ°å€
      remote_port: 8080               # è¿œç¨‹æš´éœ²ç«¯å£
    # SSH éš§é“
    - name: "ssh"
      local_addr: "127.0.0.1:22"
      remote_port: 2222

log:
  level: "info"
  file: ""
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åœ¨å…¬ç½‘æœåŠ¡å™¨ä¸Šå¯åŠ¨æœåŠ¡ç«¯

```bash
./bin/go-tunnel-server -c configs/server.yaml
```

### 2. åœ¨å†…ç½‘æœºå™¨ä¸Šå¯åŠ¨å®¢æˆ·ç«¯

```bash
./bin/go-tunnel-client -c configs/client.yaml
```

### 3. éªŒè¯éš§é“

**éªŒè¯ Web éš§é“ï¼š**
```bash
# å…ˆåœ¨å†…ç½‘å¯åŠ¨ä¸€ä¸ª Web æœåŠ¡
python3 -m http.server 8080

# ç„¶åé€šè¿‡å…¬ç½‘æœåŠ¡å™¨è®¿é—®
curl http://your-server-ip:8080
```

**éªŒè¯ SSH éš§é“ï¼š**
```bash
# é€šè¿‡å…¬ç½‘æœåŠ¡å™¨çš„ 2222 ç«¯å£è¿æ¥å†…ç½‘ SSH
ssh -p 2222 user@your-server-ip
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
go-tunnel-lite/
â”œâ”€â”€ cmd/
â”‚   â”œâ”€â”€ client/          # å®¢æˆ·ç«¯å…¥å£
â”‚   â”‚   â””â”€â”€ main.go
â”‚   â””â”€â”€ server/          # æœåŠ¡ç«¯å…¥å£
â”‚       â””â”€â”€ main.go
â”œâ”€â”€ configs/
â”‚   â”œâ”€â”€ client.yaml      # å®¢æˆ·ç«¯é…ç½®ç¤ºä¾‹
â”‚   â””â”€â”€ server.yaml      # æœåŠ¡ç«¯é…ç½®ç¤ºä¾‹
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ client/          # å®¢æˆ·ç«¯æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ server/          # æœåŠ¡ç«¯æ ¸å¿ƒé€»è¾‘
â”‚   â””â”€â”€ pkg/
â”‚       â”œâ”€â”€ config/      # é…ç½®è§£æ
â”‚       â”œâ”€â”€ connect/     # è¿æ¥ç®¡ç†
â”‚       â”œâ”€â”€ log/         # æ—¥å¿—æ¨¡å—
â”‚       â””â”€â”€ proto/       # é€šä¿¡åè®®
â”œâ”€â”€ bin/                 # ç¼–è¯‘è¾“å‡ºç›®å½•
â”œâ”€â”€ Makefile
â”œâ”€â”€ go.mod
â””â”€â”€ README.md
```

## ğŸ”§ Makefile å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `make build` | ç¼–è¯‘æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ |
| `make server` | ä»…ç¼–è¯‘æœåŠ¡ç«¯ |
| `make client` | ä»…ç¼–è¯‘å®¢æˆ·ç«¯ |
| `make test` | è¿è¡Œæµ‹è¯• |
| `make run-server` | è¿è¡ŒæœåŠ¡ç«¯ï¼ˆå¼€å‘æ¨¡å¼ï¼‰ |
| `make run-client` | è¿è¡Œå®¢æˆ·ç«¯ï¼ˆå¼€å‘æ¨¡å¼ï¼‰ |
| `make clean` | æ¸…ç†ç¼–è¯‘äº§ç‰© |
| `make help` | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ |

## ğŸ“‹ åè®®è¯´æ˜

å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¹‹é—´ä½¿ç”¨è‡ªå®šä¹‰çš„äºŒè¿›åˆ¶åè®®é€šä¿¡ï¼š

| æ¶ˆæ¯ç±»å‹ | è¯´æ˜ |
|----------|------|
| `Auth` | è®¤è¯è¯·æ±‚/å“åº” |
| `Heartbeat` | å¿ƒè·³ä¿æ´» |
| `RegisterTunnel` | æ³¨å†Œéš§é“ |
| `NewProxy` | æ–°å»ºä»£ç†è¿æ¥ |
| `ProxyData` | ä»£ç†æ•°æ®è½¬å‘ |

## ğŸ”’ å®‰å…¨å»ºè®®

1. **ä¿®æ”¹é»˜è®¤ Token** - è¯·åŠ¡å¿…ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„é»˜è®¤ Token
2. **é™åˆ¶ç«¯å£ç™½åå•** - åœ¨æœåŠ¡ç«¯é…ç½® `public_ports` é™åˆ¶å¯ç”¨ç«¯å£
3. **ä½¿ç”¨é˜²ç«å¢™** - ä»…å¼€æ”¾å¿…è¦çš„ç«¯å£
4. **å®šæœŸæ›´æ–°** - ä¿æŒè½¯ä»¶æ›´æ–°ä»¥è·å–å®‰å…¨ä¿®å¤

## ğŸ“„ License

MIT License
